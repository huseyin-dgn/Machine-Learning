ğŸ” Grid Search Nedir ? ğŸ”
 
Grid search, makine Ã¶ÄŸrenmesi ve derin Ã¶ÄŸrenme modellerinde hiperparametre optimizasyonu yapmak iÃ§in kullanÄ±lan bir yÃ¶ntemdir. Modelin performansÄ±nÄ± artÄ±rmak amacÄ±yla, belirli hiperparametreler (Ã¶rneÄŸin, Ã¶ÄŸrenme oranÄ±, batch boyutu, modelin katman sayÄ±sÄ±) Ã¼zerinde tÃ¼m olasÄ± kombinasyonlarÄ± sistematik bir ÅŸekilde tarar.

Grid search, her bir hiperparametre iÃ§in bir deÄŸer aralÄ±ÄŸÄ± tanÄ±mlar ve bu aralÄ±ktaki tÃ¼m deÄŸerlerin birleÅŸiminden oluÅŸan bir grid (Ä±zgara) oluÅŸturur. Daha sonra bu griddeki her bir kombinasyonla model eÄŸitilir ve en iyi sonucu veren hiperparametreler seÃ§ilir.

ğŸ¯ Grid Search'in KullanÄ±m AmacÄ± ? ğŸ¯

Grid search, modelin en iyi hiperparametreleriyle Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlamak iÃ§in kullanÄ±lÄ±r. Modelin hiperparametreleri, Ã¶ÄŸrenme sÃ¼reci Ã¼zerinde bÃ¼yÃ¼k bir etkiye sahiptir ve doÄŸru hiperparametreler, modelin genelleme yeteneÄŸini artÄ±rabilir. Grid search, farklÄ± hiperparametre deÄŸerlerini deneyerek en iyi performansÄ± gÃ¶steren kombinasyonu bulmayÄ± amaÃ§lar.

ğŸ† Grid Search'in AvantajlarÄ±

Basit ve Kolay Uygulama âœ…
Grid search, hiperparametreleri belirli bir aralÄ±kta sistematik bir ÅŸekilde tarar. Bu iÅŸlem, hem yeni baÅŸlayanlar hem de deneyimli kullanÄ±cÄ±lar iÃ§in oldukÃ§a anlaÅŸÄ±lÄ±r ve basittir.

TÃ¼m KombinasyonlarÄ± Dener ğŸ”„
Grid search, seÃ§ilen hiperparametrelerin tÃ¼m olasÄ±lÄ±klarÄ±nÄ± dener. Bu, modelin global optimum Ã§Ã¶zÃ¼mÃ¼ne ulaÅŸma ÅŸansÄ±nÄ± artÄ±rÄ±r.

Performans Ä°yileÅŸtirmesi ğŸ“ˆ
Hiperparametreler doÄŸru seÃ§ildiÄŸinde, modelin doÄŸruluÄŸu Ã¶nemli Ã¶lÃ§Ã¼de iyileÅŸebilir. Grid search bu doÄŸruluÄŸu artÄ±rmak iÃ§in etkili bir yÃ¶ntem sunar.

Paralel Ä°ÅŸlem YapÄ±labilir ğŸ’»
Grid search, farklÄ± hiperparametre kombinasyonlarÄ±nÄ± paralel olarak Ã§alÄ±ÅŸtÄ±rabilir, bu da Ã¶zellikle bÃ¼yÃ¼k veri setlerinde zaman tasarrufu saÄŸlar.

DetaylÄ± SonuÃ§lar Sunar ğŸ“Š
Grid search, her kombinasyonun model Ã¼zerindeki etkilerini raporlayarak, en iyi sonucu veren hiperparametreleri bulmanÄ±za olanak tanÄ±r.

âš ï¸ Grid Search'in DezavantajlarÄ±

Hesaplama ZorluÄŸu ğŸ–¥ï¸
Ã‡ok sayÄ±da hiperparametre ve geniÅŸ aralÄ±klar seÃ§ildiÄŸinde grid search hesaplama aÃ§Ä±sÄ±ndan Ã§ok zaman alÄ±cÄ± olabilir. Ã–zellikle bÃ¼yÃ¼k veri setlerinde bu iÅŸlem daha da uzun sÃ¼rebilir.

DÃ¼ÅŸÃ¼k Verimli ğŸ•’
Grid search, tÃ¼m kombinasyonlarÄ± denerken bazÄ± parametreler iÃ§in daha uygun olan deÄŸerlerin yer aldÄ±ÄŸÄ± kÃ¼Ã§Ã¼k bir bÃ¶lgeyi kaÃ§Ä±rabilir, bu da verimli olmayabilir.

BÃ¼yÃ¼k Hiperparametre AlanlarÄ±nda ZorlayÄ±cÄ± âš¡
Hiperparametrelerin sayÄ±sÄ± arttÄ±kÃ§a, grid search ile denenecek kombinasyonlarÄ±n sayÄ±sÄ± katlanarak artar. Bu, hem zaman hem de kaynak aÃ§Ä±sÄ±ndan maliyetli olabilir.

ğŸ“Š Grid Search NasÄ±l UygulanÄ±r?
Hiperparametrelerin bir aralÄ±ÄŸÄ±nÄ± seÃ§in (Ã¶rneÄŸin, Ã¶ÄŸrenme oranÄ±: 0.001, 0.01, 0.1).
Bu parametreler iÃ§in tÃ¼m olasÄ±lÄ±klarÄ± iÃ§eren bir grid oluÅŸturun.
Modeli her bir kombinasyon ile eÄŸitin ve performansÄ±nÄ± Ã¶lÃ§Ã¼n.
En iyi sonucu veren hiperparametreleri seÃ§in.
Grid search, doÄŸru kullanÄ±ldÄ±ÄŸÄ±nda modelin performansÄ±nÄ± artÄ±rmak iÃ§in gÃ¼Ã§lÃ¼ bir araÃ§ olabilir. Ancak, bÃ¼yÃ¼k parametre uzaylarÄ±nda alternatif yÃ¶ntemler, Ã¶rneÄŸin random search veya Bayesian optimization, daha verimli sonuÃ§lar verebilir.


		-- KOD BÃ–LÃœMÃœNÃœ BERABER Ä°NCELEYELÄ°M --

1ï¸âƒ£ Veri Setini BÃ¶lme (train_test_split)

from sklearn.model_selection import train_test_split

# X: BaÄŸÄ±msÄ±z deÄŸiÅŸkenler, y: BaÄŸÄ±mlÄ± deÄŸiÅŸken
# test_size=0.3: Verinin %30'u test seti, %70'i eÄŸitim seti olarak ayrÄ±lÄ±r
# random_state=9: AynÄ± sonucu elde etmek iÃ§in sabit rastgelelikik kullanÄ±lÄ±r
X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=9)

2ï¸âƒ£ Veri Standardizasyonu (StandardScaler)

from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()  # StandartlaÅŸtÄ±rma iÃ§in bir scaler nesnesi oluÅŸturuluyor
scaler.fit(X_train)  # EÄŸitim verisine gÃ¶re scaler'Ä± fit ediyoruz (ortalama ve standart sapma hesaplanÄ±r)
X_train = scaler.transform(X_train)  # EÄŸitim verisini standartlaÅŸtÄ±rÄ±yoruz (ortalama 0, std 1)
X_test = scaler.transform(X_test)  # Test verisini de aynÄ± ÅŸekilde dÃ¶nÃ¼ÅŸtÃ¼rÃ¼yoruz

3ï¸âƒ£ ElasticNet Modeli ve GridSearchCV KullanÄ±mÄ±

from sklearn.linear_model import ElasticNet
from sklearn.model_selection import GridSearchCV

elasticnet = ElasticNet()  # ElasticNet modelini baÅŸlatÄ±yoruz (hem Lasso hem Ridge kombinasyonu)

# Grid Search iÃ§in parametreler
params = {
    "alpha": [.01 , .1 , 1 , 5 ,10 , 50 , 100 , 1000],  # RegÃ¼lerizasyon gÃ¼cÃ¼ iÃ§in farklÄ± alpha deÄŸerleri
    "l1_ratio":[.001 , 0.01 , 0.1 , .5  , .7 , .9 , .95 , .99]  # Lasso ve Ridge kombinasyon oranlarÄ± iÃ§in farklÄ± deÄŸerler
}

# GridSearchCV kullanarak modelin hiperparametrelerini optimize edeceÄŸiz
grid_model = GridSearchCV(
    estimator=elasticnet,  # KullandÄ±ÄŸÄ±mÄ±z model: ElasticNet
    param_grid=params,  # Parametre grid'i: Denenecek alpha ve l1_ratio kombinasyonlarÄ±
    scoring="neg_mean_squared_error",  # Modeli negatif ortalama kare hata (MSE) ile deÄŸerlendiriyoruz
    cv=5,  # 5 katlamalÄ± Ã§apraz doÄŸrulama
    verbose=2  # Ä°ÅŸlem sÄ±rasÄ±nda daha fazla bilgi almak iÃ§in verbose=2 kullanÄ±yoruz
)

# EÄŸitim verisiyle GridSearchCV'yi eÄŸitiyoruz
grid_model.fit(X_train , y_train)

# En iyi parametreleri ve modelin en iyi tahminciyi gÃ¶rmek iÃ§in:
grid_model.best_estimator_  # En iyi parametrelerle eÄŸitilen model

# GridSearchCV'nin sonuÃ§larÄ±nÄ± DataFrame formatÄ±nda gÃ¶rÃ¼ntÃ¼lÃ¼yoruz
grid_result = pd.DataFrame(grid_model.cv_results_)

# Modelin performansÄ±nÄ± test verisi ile deÄŸerlendiriyoruz:
y_pred = grid_model.predict(X_test)  # Test verisiyle tahmin yapÄ±yoruz

from sklearn.metrics import mean_squared_error
# GerÃ§ek ve tahmin edilen deÄŸerler arasÄ±ndaki kÃ¶k ortalama kare hata (RMSE) hesaplÄ±yoruz
np.sqrt(mean_squared_error(y_test , y_pred))  # RMSE deÄŸeri


			 ---- âš ï¸ AÃ§Ä±klamalar âš ï¸ ----

1- ) train_test_split: Veri setini eÄŸitim ve test olarak ayÄ±rÄ±r. random_state sabitlenerek sonuÃ§larÄ±n her seferinde aynÄ± olmasÄ±nÄ± saÄŸlarÄ±z.

2- ) StandardScaler: Veriyi standartlaÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r. Ã–zelliklerin farklÄ± Ã¶lÃ§ekleri modelin Ã¶ÄŸrenmesini zorlaÅŸtÄ±rabilir. Bu adÄ±mda her Ã¶zelliÄŸi aynÄ± Ã¶lÃ§eÄŸe getiriyoruz.

3- ) ElasticNet: Hem Lasso hem de Ridge regresyonunun birleÅŸimi olan bir modeldir. Bu model, veri setlerinde fazla Ã¶zelliÄŸi olan durumlarda veya Ã§oklu doÄŸrusal iliÅŸkiler olduÄŸunda faydalÄ±dÄ±r.

4- ) GridSearchCV: Bu yÃ¶ntem, modelin hiperparametrelerini sistematik bir ÅŸekilde arar. Grid search ile modelin performansÄ±, parametre kombinasyonlarÄ± Ã¼zerinden optimize edilir. Burada kullandÄ±ÄŸÄ±mÄ±z scoring="neg_mean_squared_error", modeli negatif ortalama kare hata ile deÄŸerlendirir (daha dÃ¼ÅŸÃ¼k hata, daha iyi sonuÃ§).


		---- ğŸ¤– Neden ElasticNet KullanÄ±ldÄ±? ğŸ¤– ----

ElasticNet, Lasso ve Ridge regresyonunun birleÅŸimidir. Ä°ÅŸte kullanÄ±lma sebepleri:

1ï¸âƒ£ Lasso (L1) ve Ridge (L2) AvantajlarÄ±nÄ± BirleÅŸtirme
Lasso: Ã–zellik seÃ§imi yaparak bazÄ± katsayÄ±larÄ± sÄ±fÄ±ra indirir.
Ridge: Ã–zelliklerin katsayÄ±larÄ±nÄ± kÃ¼Ã§Ã¼ltÃ¼r ama sÄ±fÄ±r yapmaz.

2ï¸âƒ£ Ã‡oklu DoÄŸrusal BaÄŸlantÄ± SorunlarÄ±
ElasticNet, Ã§oklu doÄŸrusal baÄŸlantÄ± (multicollinearity) olan veri setlerinde daha iyi sonuÃ§lar verir.

3ï¸âƒ£ YÃ¼ksek Boyutlu Veri Setleri
Fazla Ã¶zellik olduÄŸunda, ElasticNet her iki regÃ¼lerizasyon tÃ¼rÃ¼nÃ¼ kullanarak genellenebilir bir model oluÅŸturur.

4ï¸âƒ£ Daha Ä°yi Genellenebilirlik
EÄŸitim verisiyle Ã§ok uyum saÄŸlama (overfitting) sorununu Ã¶nleyerek test verisinde daha saÄŸlam sonuÃ§lar elde edilir.
ElasticNet, bu Ã¶zellikleriyle dengeleme saÄŸlar ve daha doÄŸru tahminler yapar.


ğŸ“Š GridSearchCV SonuÃ§larÄ± Ne Anlama Geliyor? ğŸ¤”
GridSearchCV sonuÃ§larÄ±nÄ±z, ElasticNet modelinin farklÄ± parametre kombinasyonlarÄ± ile nasÄ±l performans gÃ¶sterdiÄŸini anlamanÄ±zÄ± saÄŸlar. Ä°ÅŸte sÃ¼tunlarÄ±n anlamlarÄ±:

1ï¸âƒ£ mean_fit_time: Modelin eÄŸitim sÃ¼resinin ortalama deÄŸeri (saniye cinsinden).

2ï¸âƒ£ std_fit_time: EÄŸitim sÃ¼resinin deÄŸiÅŸkenliÄŸi (standart sapma).

3ï¸âƒ£ mean_score_time: Modelin tahmin yapma sÃ¼resinin ortalama deÄŸeri.

4ï¸âƒ£ std_score_time: Tahmin sÃ¼resinin deÄŸiÅŸkenliÄŸi (standart sapma).

5ï¸âƒ£ param_alpha: ElasticNet'in alpha parametresi deÄŸeri.

6ï¸âƒ£ param_l1_ratio: ElasticNet'in l1_ratio parametresi (Lasso ve Ridge oranÄ±).

7ï¸âƒ£ params: KullanÄ±lan parametrelerin tÃ¼mÃ¼ (alpha ve l1_ratio).

8ï¸âƒ£ split0_test_score - split4_test_score: 5 katlamalÄ± Ã§apraz doÄŸrulamada elde edilen test puanlarÄ±.

9ï¸âƒ£ mean_test_score: Test setinin ortalama puanÄ±.

ğŸ”Ÿ std_test_score: Test puanlarÄ±nÄ±n standart sapmasÄ±.

1ï¸âƒ£1ï¸âƒ£ rank_test_score: En iyi modelin sÄ±ralamasÄ± (1 en iyi).

ğŸ¯ Ã–rnek:
En iyi model: param_alpha = 0.01, param_l1_ratio = 0.001 kombinasyonu ile mean_test_score = -95.17. Bu model, 6. sÄ±rada yer alÄ±yor ve en iyi sonucu veriyor.

Daha kÃ¶tÃ¼ sonuÃ§lar: param_alpha = 1000, param_l1_ratio = 0.5 kombinasyonu mean_test_score = -136.13 ve 43. sÄ±rada yer alÄ±yor.

ğŸ”‘ Ã–zet:
En iyi parametre kombinasyonunu bulmak iÃ§in rank_test_score kullanarak sÄ±ralama yapÄ±labilir.
DÃ¼ÅŸÃ¼k mean_test_score ve rank_test_score = 1 en iyi modelin gÃ¶stergesidir.


